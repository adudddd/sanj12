<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Message Flower Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Charm&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0e6d2;
            font-family: 'Charm', cursive;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        #envelope {
            width: 300px;
            height: 200px;
            background-color: #e6d5b8;
            position: relative;
            cursor: pointer;
            border: 2px solid #8b4513;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            transition: all 0.5s ease;
        }
        #stamp {
            width: 80px;
            height: 80px;
            background-color: #8b0000;
            position: absolute;
            top: 10px;
            right: 10px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #f0e6d2;
            font-weight: bold;
            font-size: 12px;
            text-align: center;
            line-height: 1.2;
            padding: 5px;
        }
        #envelope-content {
            display: none;
            text-align: center;
            padding: 20px;
            font-size: 24px;
        }
        .flower {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        #game-container {
            display: none;
            width: 100vw;
            height: 100vh;
            position: absolute;
            top: 0;
            left: 0;
        }
        #message-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            display: none;
            z-index: 1000;
            font-size: 24px;
            text-align: center;
        }
        #final-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 36px;
            text-align: center;
            display: none;
            z-index: 1001;
        }
        button {
            font-family: 'Charm', cursive;
            font-size: 20px;
            padding: 10px 20px;
            background-color: #8b0000;
            color: #f0e6d2;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="envelope">
        <div id="stamp">Secret message for you BC</div>
    </div>
    <div id="envelope-content">
        <h2>From Shivi</h2>
        <h2>To My sanju</h2>
        <button id="start-game">Start Game</button>
    </div>
    <div id="game-container"></div>
    <div id="message-popup"></div>
    <div id="final-message"></div>

    <script>
        const envelope = document.getElementById('envelope');
        const envelopeContent = document.getElementById('envelope-content');
        const gameContainer = document.getElementById('game-container');
        const startGameButton = document.getElementById('start-game');
        const messagePopup = document.getElementById('message-popup');
        const finalMessage = document.getElementById('final-message');

        let flowers = [];
        let gameInProgress = false;
        let messagesLeft = 13;

        const messages = [
            "Sanju get well soon",
            "Ensure that you get a second opinion from another doctor",
            "You have the potential to become a judge",
            "Let's go bungee jumping and rafting next month",
            "Take me on a trip along with our moms",
            "You are precious to me",
            "I miss your special lunches, especially the soya rice and chowmein",
            "You always bring joy and laughter",
            "I apologize for not being there when you needed me",
            "I promise to be a better friend",
            "I promise I will never leave you",
            "Our children should go to the same school",
            "I don't want to lose you"
        ];

        envelope.addEventListener('click', () => {
            envelope.style.transform = 'scale(0)';
            setTimeout(() => {
                envelope.style.display = 'none';
                envelopeContent.style.display = 'block';
            }, 500);
        });

        function createFlowerSVG(size) {
            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, "svg");
            svg.setAttribute("viewBox", "0 0 100 100");
            svg.setAttribute("width", size);
            svg.setAttribute("height", size);

            const flower = document.createElementNS(svgNS, "g");

            const petalCount = Math.floor(Math.random() * 3) + 5; // 5 to 7 petals
            const color = `hsl(${Math.random() * 360}, 100%, 50%)`;

            for (let i = 0; i < petalCount; i++) {
                const petal = document.createElementNS(svgNS, "ellipse");
                petal.setAttribute("cx", "50");
                petal.setAttribute("cy", "50");
                petal.setAttribute("rx", "20");
                petal.setAttribute("ry", "35");
                petal.setAttribute("fill", color);
                petal.setAttribute("transform", `rotate(${i * (360 / petalCount)} 50 50)`);
                flower.appendChild(petal);
            }

            const center = document.createElementNS(svgNS, "circle");
            center.setAttribute("cx", "50");
            center.setAttribute("cy", "50");
            center.setAttribute("r", "15");
            center.setAttribute("fill", `hsl(${Math.random() * 360}, 100%, 50%)`);
            flower.appendChild(center);

            svg.appendChild(flower);
            return svg;
        }

        function createFlower(message) {
            const size = Math.random() * 50 + 30; // Random size between 30 and 80
            const flower = document.createElement('div');
            flower.className = 'flower';
            flower.style.left = Math.random() * (window.innerWidth - size) + 'px';
            flower.style.top = window.innerHeight + 'px'; // Start below the screen
            
            const speed = Math.random() * 2 + 1; // Random speed between 1 and 3
            
            flower.appendChild(createFlowerSVG(size));
            
            flower.addEventListener('click', () => {
                if (gameInProgress) {
                    popFlower(flower, message);
                }
            });
            
            gameContainer.appendChild(flower);
            return { element: flower, speed, message };
        }

        function popFlower(flower, message) {
            if (messagesLeft > 0 && flower && flower.element && flower.element.parentNode) {
                showMessage(message);
                messagesLeft--;
                
                flower.element.parentNode.removeChild(flower.element);
                flowers = flowers.filter(f => f !== flower);
                
                if (messagesLeft === 0) {
                    setTimeout(formHeartShape, 1000);
                }
            }
        }

        function showMessage(message) {
            messagePopup.textContent = message;
            messagePopup.style.display = 'block';
            setTimeout(() => {
                messagePopup.style.display = 'none';
            }, 2000);
        }

        function moveFlowers() {
            flowers.forEach(flower => {
                if (flower && flower.element) {
                    const rect = flower.element.getBoundingClientRect();
                    
                    // Move the flower upwards
                    flower.element.style.top = rect.top - flower.speed + 'px';
                    
                    // If the flower has moved off the top of the screen, reset its position to the bottom
                    if (rect.bottom < 0) {
                        flower.element.style.top = window.innerHeight + 'px';
                        flower.element.style.left = Math.random() * (window.innerWidth - flower.element.offsetWidth) + 'px';
                    }
                }
            });
            requestAnimationFrame(moveFlowers);
        }

        function formHeartShape() {
            finalMessage.textContent = "You are loved!";
            finalMessage.style.display = 'block';

            const heartPoints = [
                { x: 50, y: 15 },
                { x: 30, y: 35 },
                { x: 20, y: 50 },
                { x: 50, y: 85 },
                { x: 80, y: 50 },
                { x: 80, y: 35 },
                { x: 70, y: 15 },
            ];

            const heartSize = 300;
            const offsetX = (window.innerWidth - heartSize) / 2;
            const offsetY = (window.innerHeight - heartSize) / 2;

            flowers = messages.map((message, index) => {
                const point = heartPoints[index % heartPoints.length];
                const size = Math.random() * 50 + 30;
                const flower = document.createElement('div');
                flower.className = 'flower';
                flower.style.left = `${offsetX + (point.x / 100) * heartSize - size / 2}px`;
                flower.style.top = `${offsetY + (point.y / 100) * heartSize - size / 2}px`;

                flower.appendChild(createFlowerSVG(size));
                gameContainer.appendChild(flower);
                return { element: flower, message };
            });

            setTimeout(() => {
                flowers.forEach(flower => {
                    if (flower && flower.element && flower.element.parentNode) {
                        flower.element.parentNode.removeChild(flower.element);
                    }
                });
                finalMessage.style.display = 'none';
                envelope.style.transform = 'scale(1)';
                envelope.style.display = 'flex';
                envelopeContent.style.display = 'none';
            }, 5000);
        }

        startGameButton.addEventListener('click', () => {
            envelopeContent.style.display = 'none';
            gameContainer.style.display = 'block';
            gameInProgress = true;

            messages.forEach(message => {
                const flower = createFlower(message);
                flowers.push(flower);
            });

            moveFlowers();
        });

    </script>
</body>
</html>
